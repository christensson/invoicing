<script marko-init>
    var i18n = require("i18next");
    var news = require("../news.json");
    var navbarUseAnnotatedIcons = false;
</script>
<!DOCTYPE html>

<macro icon(icon, tooltip, extraClass, isExplicitIcon)>
    <if ("${isExplicitIcon}" == "true")>
        <i class="fa ${icon} ${extraClass}" aria-hidden="true" data-placement="top" title="${tooltip}"></i>
    </if>
    <else>
        <i class="fa fa-${icon} ${extraClass}" aria-hidden="true" data-placement="top" title="${tooltip}"></i>
    </else>
</macro>

<macro iconFw(icon, tooltip, extraClass, isExplicitIcon)>
    <icon icon="${icon}" tooltip="${tooltip}" extraClass="fa-fw ${extraClass}" isExplicitIcon="${isExplicitIcon}"/>
</macro>

<macro iconLg(icon, tooltip, extraClass, isExplicitIcon)>
    <icon icon="${icon}" tooltip="${tooltip}" extraClass="fa-lg ${extraClass}" isExplicitIcon="${isExplicitIcon}"/>
</macro>

<macro iconFwLg(icon, tooltip, extraClass, isExplicitIcon)>
    <iconFw icon="${icon}" tooltip="${tooltip}" extraClass="fa-lg ${extraClass}" isExplicitIcon="${isExplicitIcon}"/>
</macro>

<macro condIcon(cond, icon, tooltip, extraClass)>
    <span data-bind="if: ${cond}">
        <icon icon="${icon}" tooltip="${tooltip}" extraClass="${extraClass}"/>
    </span>
</macro>

<macro condCheckIcon(cond, tooltip, extraClass)>
    <condIcon cond="${cond}" icon="check" tooltip="${tooltip}" extraClass="${extraClass}"/>
</macro>

<macro condLockIcon(cond, tooltip, extraClass)>
    <condIcon cond="${cond}" icon="lock" tooltip="${tooltip}" extraClass="${extraClass}"/>
</macro>

<macro filterLabelToggle(condVar, text, action)>
    <button class="btn btn-xs label-fix" data-bind="css: {'btn-default': !${condVar}(), 'btn-success': ${condVar}},
                                             click: function() { ${condVar}(!${condVar}()); }">
        <condIcon cond="${condVar}" icon="eye" extraClass="inline-icon-left-fix"/>
        <condIcon cond="!${condVar}()" icon="eye-slash" extraClass="inline-icon-left-fix"/>
        ${text}
    </button>
</macro>

<macro navbarDropdown(tKey, icon, isExplicitIcon)>
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
      <iconFwLg icon="${icon}" isExplicitIcon="${isExplicitIcon}"/>
      <span data-bind="text: t('${tKey}')"></span>
      <span class="caret"></span>
    </a>
</macro>

<macro navbarItem(route, tKey, icon, isExplicitIcon)>
    <li data-bind="css: { active: '${route}'.split('/').slice(-1)[0] == currentView() }">
        <a href="#" data-bind="click: selectViewRoute.bind(null, '${route}')">
            <iconFwLg icon="${icon}" isExplicitIcon="${isExplicitIcon}"/>
            <span data-bind="text: t('${tKey}')"></span>
        </a>
    </li>
</macro>

<macro navbarItemServerRoute(route, tKey, icon, isExplicitIcon)>
    <li>
        <a href="${route}">
            <iconFwLg icon="${icon}" isExplicitIcon="${isExplicitIcon}"/>
            <span data-bind="text: t('${tKey}')"></span>
        </a>
    </li>
</macro>

<macro itemTextWithEditMode(textVariable, cond, editModeVariable, useTextarea)>
    <div data-bind="ifnot: ${editModeVariable}">
        <div data-bind="if: ${cond}">
            <p class="list-group-item-text"
                data-bind="text: ${textVariable}"/>
        </div>
    </div>
    <div data-bind="if: ${editModeVariable}">
        <if ("${useTextarea}" == "true")>
          <textarea type="text"
              class="form-control input-sm"
              data-bind="value: ${textVariable}, enable: ${cond}"/>
        </if>
        <else>
          <input type="text"
              class="form-control input-sm"
              data-bind="value: ${textVariable}, enable: ${cond}"/>
        </else>
    </div>
</macro>

<html>
    <head>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <title>${i18n.t('app.pageTitle')}</title>
        <link rel="stylesheet" type="text/css" href="bootstrap.min.css"/>
        <link rel="stylesheet" type="text/css" href="font-awesome.min.css"/>
        <link rel="stylesheet" type="text/css" href="page.css"/>
    </head>
    <body role="document">
        <nav class="navbar navbar-default navbar-fixed-top" id="app-navbar">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed"
                        data-toggle="collapse" data-target=".navbar-collapse">

                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"/>
                        <span class="icon-bar"/>
                        <span class="icon-bar"/>
                    </button>
                    <a class="navbar-brand" href="#/page/home">
                        ${i18n.t('app.navBar.title')}
                    </a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <navbarItem route="/page/home" tKey="app.navBar.home" icon="home"/>

                        <li class="drowdown">
                            <navbarDropdown tKey="app.navBar.customerMenu" icon="user"/>
                            <ul class="dropdown-menu" role="menu">
                                <navbarItem route="/page/customer_new" tKey="app.navBar.customerNew" icon="user-plus"/>
                                <navbarItem route="/page/customers" tKey="app.navBar.customerList" icon="users"/>
                            </ul>
                        </li>

                        <li class="drowdown">
                            <navbarDropdown tKey="app.navBar.invoiceMenu" icon="file-text"/>
                            <ul class="dropdown-menu" role="menu">
                                <navbarItem route="/page/invoice_new" tKey="app.navBar.invoiceNew" icon="file-text"/>
                                <navbarItem route="/page/invoices" tKey="app.navBar.invoiceList" icon="list"/>
                                <li role="separator" class="divider"/>
                                <navbarItem route="/page/invoice_item_group_templates" tKey="app.navBar.invoiceItemGroupTemplates" icon="list-alt"/>
                                <navbarItem route="/page/articles" tKey="app.navBar.articles" icon="cubes"/>
                            </ul>
                        </li>

                        <li class="drowdown">
                            <navbarDropdown tKey="app.navBar.offerMenu" icon="file-text"/>
                            <ul class="dropdown-menu" role="menu">
                                <navbarItem route="/page/offer_new" tKey="app.navBar.offerNew" icon="file-text"/>
                                <navbarItem route="/page/offers" tKey="app.navBar.offerList" icon="list"/>
                            </ul>
                        </li>

                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                                <iconFwLg icon="briefcase" extraClass="inline-icon-left-fix"/>
                                <span data-bind="text: activeCompanyName"/>
                                <span class="caret"/>
                            </a>
                            <ul class="dropdown-menu" role="menu">
                                <html-comment>
                                    ko foreach: companyList
                                </html-comment>
                                <li data-bind="css: { active: _id() == $parent.activeCompanyId() }">
                                    <a href="#" data-bind="click: $root.selectCompany">
                                        <span data-bind="text: name"/>
                                        <condCheckIcon cond="_id() == $parent.activeCompanyId()" extraClass="inline-icon-right-fix"/>
                                    </a>
                                </li>
                                <html-comment> /ko </html-comment>
                                <li role="separator" class="divider"/>
                                <navbarItem route="/page/companies" tKey="app.navBar.companyAdmin" icon="briefcase"/>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                                <iconFwLg icon="user" extraClass="inline-icon-left-fix"/>
                                <span data-bind="text: userName"/>
                                <span if(data.user.isAdmin === true)
                                    class="label label-primary label-fix">
                                    ${i18n.t('app.navBar.adminUserLbl')}
                                </span>
                                <span class="caret"/>
                            </a>
                            <ul class="dropdown-menu" role="menu">
                                <navbarItem route="/page/settings" tKey="app.navBar.settings" icon="wrench"/>

                                <if(data.user.isAdmin === true)>
                                    <li role="separator" class="divider"/>
                                    <navbarItem route="/page/debug" tKey="app.navBar.debug" icon="bug"/>
                                    <navbarItem route="/page/users" tKey="app.navBar.users" icon="users"/>
                                    <navbarItem route="/page/invites" tKey="app.navBar.invites" icon="gift"/>
                                </if>

                                <li role="separator" class="divider"/>
                                <navbarItemServerRoute route="/logout" tKey="app.navBar.logout" icon="sign-out"/>
                            </ul>
                        </li>
                    </ul>
                </div>
                <!-- /.nav-collapse -->
            </div>
        </nav>
        <div id="layout">
            <div id="main" class="container">
                <include("./notification.marko")/>
                <div id="app-home" data-bind="visible: currentView() == 'home'"
                    style="display: none">

                    <div class="page-header">
                        <h1>${i18n.t('app.home.pageHeader')}</h1>
                    </div>
                    <div>
                        <p>$!{i18n.t('app.home.greetingsText')}</p>
                        <div class="row top15">
                            <div class="col-md-12">
                                <div class="panel-group"
                                    data-bind="visible: enabled"
                                    style="display: none">

                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="panel" data-bind="css: {\"panel-primary\": numCompanies() == 0, \"panel-success\": numCompanies() > 0}">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">
                                                        ${i18n.t('app.gettingStarted.companiesHeader')}
                                                    </h3>
                                                </div>
                                                <div class="panel-body">
                                                    <p>
                                                        <span data-bind="html: companiesTextTrans"/>
                                                    </p>
                                                    <div class="btn-group"
                                                        role="group">

                                                        <a href="#/page/company_new"
                                                            type="button"
                                                            class="btn btn-success">
                                                            <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                                            ${i18n.t('app.gettingStarted.companiesNewCompanyBtn')}

                                                        </a>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div data-bind="if: numCompanies() > 0">
                                                <div class="panel" data-bind="css: {\"panel-primary\": numCustomers() == 0, \"panel-success\": numCustomers() > 0}">
                                                    <div class="panel-heading">
                                                        <h3 class="panel-title">
                                                            ${i18n.t('app.gettingStarted.customersHeader')}
                                                        </h3>
                                                    </div>
                                                    <div class="panel-body">
                                                        <p>
                                                            <span data-bind="html: customersTextTrans"/>
                                                        </p>
                                                        <div class="btn-group" role="group">
                                                            <a href="#/page/customer_new" type="button" class="btn btn-success">
                                                                <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                                                ${i18n.t('app.gettingStarted.customersNewCustomerBtn')}
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div data-bind="if: numCustomers() > 0">
                                                <div class="panel" data-bind="css: {\"panel-primary\": numInvoices() == 0, \"panel-success\": numInvoices() > 0}">
                                                    <div class="panel-heading">
                                                        <h3 class="panel-title">
                                                            ${i18n.t('app.gettingStarted.invoicesHeader')}
                                                        </h3>
                                                    </div>
                                                    <div class="panel-body">
                                                        <p>
                                                            <span data-bind="html: invoicesTextTrans"/>
                                                        </p>
                                                        <div class="btn-group" role="group">
                                                            <a href="#/page/invoice_new" type="button" class="btn btn-success">
                                                                <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                                                ${i18n.t('app.gettingStarted.invoicesNewInvoiceBtn')}
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="row top20">
                            <div class="col-md-12">
                                <div class="panel-group">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="panel panel-info">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">
                                                        ${i18n.t('app.gettingStarted.newsHeader')}
                                                    </h3>
                                                </div>
                                                <table class="table table-condensed">
                                                    <colgroup>
                                                        <col class="col-md-1"/>
                                                        <col class="col-md-2"/>
                                                        <col class="col-md-9"/>
                                                    </colgroup>
                                                    <tr for(item in news.items)>
                                                        <td>${item.date}</td>
                                                        <td>
                                                            ${item.msgSlogan.sv}
                                                        </td>
                                                        <td>
                                                            $!{item.msg.sv}
                                                        </td>
                                                    </tr>
                                                </table>
                                                <!--
                                                <div class="panel-body">
                                                  <dl>
                                                    <for each="item in news.items">
                                                      <dt>${item.date} - ${item.msgSlogan.sv}</dt>
                                                      <dd>$!{item.msg.sv}</dd>
                                                    </for>
                                                  </dl>
                                                </div>
                                                -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div id="app-companies"
                    data-bind="visible: currentView() == 'companies'"
                    style="display: none">

                    <form>
                        <p>
                            <table class="table table-striped table-condensed">
                                <thead>
                                    <tr>
                                        <th/>
                                        <th>
                                            ${i18n.t('app.companyList.nameCol')}
                                        </th>
                                        <th>
                                            ${i18n.t('app.companyList.addrCol', {nr: 1})}
                                        </th>
                                        <th>
                                            ${i18n.t('app.companyList.addrCol', {nr: 2})}
                                        </th>
                                        <th>
                                            ${i18n.t('app.companyList.addrCol', {nr: 3})}
                                        </th>
                                    </tr>
                                </thead>
                                <tbody data-bind="foreach: companyList">
                                    <tr data-bind="css: { info: _id() == $parent.activeCompanyId() }">
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <a class="btn btn-info" data-bind="attr: { href: '#/page/company_show/' + _id() }">
                                                    <icon icon="pencil"/>
                                                </a>
                                                <button type="button"
                                                    class="btn btn-info" data-bind="click: $parent.activateCompany, disable: _id() == $parent.activeCompanyId()">
                                                    <icon icon="check"/>
                                                </button>
                                            </div>
                                        </td>
                                        <td>
                                            <p class="form-control-static"
                                                data-bind="text: name"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static"
                                                data-bind="text: addr1"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static"
                                                data-bind="text: addr2"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static"
                                                data-bind="text: addr3"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </p>
                        <div class="btn-group" role="group">
                            <a href="#/page/company_new" type="button" class="btn btn-success">
                                <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                ${i18n.t('app.companyList.newCompanyBtn')}
                            </a>
                        </div>
                    </form>

                </div>
                <div id="app-company_new" data-bind="visible: currentView() == 'company_new' || (currentView() != undefined && currentView().search('company_show') == 0)"
                    style="display: none">

                    <div class="panel-group">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">
                                    ${i18n.t('app.company.generalPaneHeader')}
                                </h3>
                            </div>
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label for="name"
                                            class="col-sm-2 control-label">

                                            ${i18n.t('app.company.companyNameLbl')}

                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" id="name"
                                                class="form-control" data-bind="value: data.name, css: data.hasErrorCss"/>
                                        </div>
                                    </div>
                                    <div for(idx from 1 to 3)>
                                        <div class="form-group">
                                            <label for="addr${idx}"
                                                class="col-sm-2 control-label">

                                                ${i18n.t('app.company.addrLbl', {nr: (idx)})}

                                            </label>
                                            <div class="col-sm-4">
                                                <input type="text"
                                                    id="addr${idx}"
                                                    class="form-control"
                                                    data-bind="value: data.addr${idx}"/>
                                            </div>
                                        </div>
                                    </div>
                                    <hr/>
                                    <div class="form-group">
                                        <label for="vatNr"
                                            class="col-sm-2 control-label">

                                            ${i18n.t('app.company.vatNrLbl')}

                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" id="vatNr"
                                                class="form-control"
                                                data-bind="value: data.vatNr"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="orgNr"
                                            class="col-sm-2 control-label">

                                            ${i18n.t('app.company.orgNrLbl')}

                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" id="orgNr"
                                                class="form-control"
                                                data-bind="value: data.orgNr"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <div class="form-inline">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <span class="panel-title">
                                                ${i18n.t('app.company.contactPaneHeader')}
                                            </span>
                                            <span class="pull-right">
                                                <span class="form-group form-group-sm">
                                                    <label for="showLngSelect"
                                                        class="control-label right7">

                                                        ${i18n.t('app.company.showLngLbl')}

                                                    </label>
                                                    <select id="showLngSelect"
                                                        class="form-control" data-bind="options: invoiceLngList, optionsText: getInvoiceLngDesc, value: data.contactPaneLng">


                                                    </select>
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="row">
                                        <div class="col-md-2">
                                            <label class="control-label">
                                                ${i18n.t('app.company.contactCaptionHeader')}
                                            </label>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="control-label">
                                                ${i18n.t('app.company.contactInfoHeader')}
                                            </label>
                                        </div>
                                    </div>
                                    <div class="row top5" for(idx in [1,2,3])>
                                        <div class="col-md-2">
                                            <input type="text"
                                                id="contact${idx}Cap"
                                                class="form-control" data-bind="value: data.contact${idx}Caption"/>
                                        </div>
                                        <div class="col-md-3">
                                            <input type="text" id="contact${idx}"
                                                class="form-control"
                                                data-bind="value: data.contact${idx}"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <div class="form-inline">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <span class="panel-title">
                                                ${i18n.t('app.company.paymentOptPaneHeader')}
                                            </span>
                                            <span class="pull-right">
                                                <span class="form-group form-group-sm">
                                                    <label for="showLngSelect" class="control-label right7">
                                                        ${i18n.t('app.company.showLngLbl')}
                                                    </label>
                                                    <select id="showLngSelect"
                                                        class="form-control" data-bind="options: invoiceLngList, optionsText: getInvoiceLngDesc, value: data.paymentOptPaneLng">
                                                    </select>
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="row">
                                        <div class="col-md-2">
                                            <label class="control-label">
                                                ${i18n.t('app.company.paymentOptCaptionHeader')}
                                            </label>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="control-label">
                                                ${i18n.t('app.company.paymentOptInfoHeader')}
                                            </label>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="control-label">
                                                ${i18n.t('app.company.paymentOptFocusHeader')}
                                            </label>
                                        </div>
                                    </div>
                                    <div class="row top5" for(idx in [1,2,3])>
                                        <div class="col-sm-2">
                                            <input type="text" id="pay${idx}Cap"
                                                class="form-control" data-bind="value: data.payment${idx}Caption"/>
                                        </div>
                                        <div class="col-sm-3">
                                            <input type="text" id="pay${idx}"
                                                class="form-control"
                                                data-bind="value: data.payment${idx}"/>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="radio">
                                                <label>
                                                    <input type="radio" data-bind="checked: data.paymentFocus"
                                                        value=idx
                                                        name="paymentFocusRadios"/>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <hr/>
                                    <div class="form-group">
                                        <label for="payCustomText" class="col-md-2 control-label">
                                            ${i18n.t('app.company.paymentOptCustomTextHeader')}
                                        </label>
                                        <div class="col-sm-6">
                                            <textarea rows="4" id="payCustomText"
                                                class="form-control" data-bind="value: data.paymentCustomText"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="defNumDaysUntilPayment" class="col-md-2 control-label">
                                            ${i18n.t('app.company.paymentOptDefNumDaysUntilPayLbl')}
                                        </label>
                                        <div class="col-md-3">
                                            <input type="number"
                                                class="form-control"
                                                id="defNumDaysUntilPayment" data-bind="value: data.defaultNumDaysUntilPayment"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <div class="form-inline">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <span class="panel-title">
                                                ${i18n.t('app.company.customTextFieldsPaneHeader')}
                                            </span>
                                            <span class="pull-right">
                                                <span class="form-group form-group-sm">
                                                    <label for="showLngSelect"
                                                        class="control-label right7">

                                                        ${i18n.t('app.company.showLngLbl')}

                                                    </label>
                                                    <select id="showLngSelect"
                                                        class="form-control" data-bind="options: invoiceLngList, optionsText: getInvoiceLngDesc, value: data.customTextFieldsPaneLng">


                                                    </select>
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label for="reverseChargeText" class="col-sm-2 control-label">
                                            ${i18n.t('app.company.customTextFieldsReverseChargeTextLbl')}
                                        </label>
                                        <div class="col-sm-6">
                                            <textarea rows="4"
                                                id="reverseChargeText"
                                                class="form-control" data-bind="value: data.reverseChargeText" aria-describedby="reverseChargeTextHelp"/>
                                            <span id="reverseChargeTextHelp" class="help-block">
                                                ${i18n.t('app.company.customTextFieldsReverseChargeHelpText')}
                                            </span>
                                            <button class="btn btn-default btn-sm" data-bind="click: setDefaultReverseChargeText">
                                                ${i18n.t('app.company.customTextFieldsReverseChargeSetDefaultBtn')}
                                            </button>
                                        </div>
                                    </div>
                                    <hr/>
                                    <div class="form-group">
                                        <label for="footerText" class="col-sm-2 control-label">
                                            ${i18n.t('app.company.customTextFieldsFooterTextLbl')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" id="footerText"
                                                class="form-control"
                                                data-bind="value: data.vatNrCustomText"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">
                                    ${i18n.t('app.company.reportStylePaneHeader')}
                                </h3>
                            </div>
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label for="invoiceStyleSelect"
                                            class="col-sm-2 control-label">

                                            ${i18n.t('app.invoiceStyle.selectLbl')}

                                        </label>
                                        <div class="col-sm-4">
                                            <select id="invoiceStyleSelect"
                                                class="form-control" data-bind="options: invoiceStyleList, optionsText: getInvoiceStyleDesc, value: data.invoiceStyle">


                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">
                                    ${i18n.t('app.company.countersPaneHeader')}
                                </h3>
                            </div>
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label for="cid"
                                            class="col-sm-2 control-label">

                                            ${i18n.t('app.company.countersNextCustomerNrLbl')}

                                        </label>
                                        <div class="col-sm-4">
                                            <input type="number" id="cid"
                                                class="form-control" data-bind="value: data.nextCid, disable: currentView() != 'company_new'"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="iid"
                                            class="col-sm-2 control-label">

                                            ${i18n.t('app.company.countersNextInvoiceNrLbl')}

                                        </label>
                                        <div class="col-sm-4">
                                            <input type="number" id="iid"
                                                class="form-control" data-bind="value: data.nextIid, disable: currentView() != 'company_new'"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="oid"
                                            class="col-sm-2 control-label">

                                            ${i18n.t('app.company.countersNextOfferNrLbl')}

                                        </label>
                                        <div class="col-sm-4">
                                            <input type="number" id="oid"
                                                class="form-control" data-bind="value: data.nextOid, disable: currentView() != 'company_new'"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">
                                    ${i18n.t('app.company.logoPaneHeader')}
                                </h3>
                            </div>
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <p data-bind="visible: data._id() == undefined">
                                        ${i18n.t('app.company.logoUploadCompanyNotSavedText')}
                                    </p>
                                    <div data-bind="visible: data._id() != undefined">
                                        <div class="row">
                                            <form class="form-horizontal"
                                                id="logoUploadForm"
                                                action="/api/company_logo" accept="image/gif, image/jpeg, image/png"
                                                method="POST"
                                                data-bind="submit: uploadLogo"
                                                enctype="multipart/form-data">

                                                <div class="col-sm-6">
                                                    <div class="input-group">
                                                        <input type="file"
                                                            name="logo"
                                                            id="companyLogoInput"
                                                            class="form-control" placeholder=i18n.t("app.company.logoSelectPlaceholder") data-bind="value: companyLogoInput"/>
                                                        <span class="input-group-btn">
                                                            <button class="btn btn-default"
                                                                type="submit" data-bind="css: {'btn-primary': companyLogoInput() != ''}">

                                                                <icon icon="upload" extraClass="inline-icon-left-fix"/>
                                                                ${i18n.t('app.company.logoUploadBtn')}

                                                            </button>
                                                        </span>
                                                    </div>
                                                </div>

                                            </form>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <img id="companyLogoImg"
                                                    data-bind="attr: { src: logoPath }"
                                                    class="img-thumbnail"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-success"
                            data-bind="click: saveCompany">
                            <icon icon="save" extraClass="inline-icon-left-fix"/>
                            ${i18n.t('app.company.companySaveBtn')}
                        </button>
                    </div>

                </div>
                <div id="app-customer"
                    data-bind="visible: currentView() == 'customers'"
                    style="display: none">

                    <form>
                        <p>
                            <table class="table table-striped table-condensed">
                                <thead>
                                    <tr>
                                        <th/>
                                        <th>
                                            ${i18n.t('app.customerList.cidCol')}
                                        </th>
                                        <th>
                                            ${i18n.t('app.customerList.nameCol')}
                                        </th>
                                        <th>
                                            ${i18n.t('app.customerList.addrCol', {nr: 1})}
                                        </th>
                                        <th>
                                            ${i18n.t('app.customerList.addrCol', {nr: 2})}
                                        </th>
                                        <th>
                                            ${i18n.t('app.customerList.addrCol', {nr: 3})}
                                        </th>
                                        <th>
                                            ${i18n.t('app.customerList.phoneCol', {nr: 1})}
                                        </th>
                                        <th>
                                            ${i18n.t('app.customerList.phoneCol', {nr: 2})}
                                        </th>
                                    </tr>
                                </thead>
                                <tbody data-bind="foreach: customerList">
                                    <tr>
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <a class="btn btn-info" data-bind="attr: { href: '#/page/customer_show/' + _id() }">
                                                    <icon icon="pencil"/>
                                                </a>
                                            </div>
                                        </td>
                                        <td>
                                            <p class="form-control-static"
                                                data-bind="text: cid, visible: isValid"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: name, visible: isValid"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: addr1, visible: isValid"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: addr2, visible: isValid"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: addr3, visible: isValid"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: phone1, visible: isValid"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: phone2, visible: isValid"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </p>
                        <div class="btn-group" role="group">
                            <a href="#/page/customer_new" type="button"
                                class="btn btn-success">
                                <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                ${i18n.t('app.customerList.newCustomerBtn')}
                            </a>
                        </div>
                    </form>

                </div>
                <div id="app-customer_new" data-bind="visible: currentView() == 'customer_new' || (currentView() != undefined && currentView().search('customer_show') == 0)"
                    style="display: none">

                    <div class="form-horizontal">
                        <div class="panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">
                                        ${i18n.t('app.customer.generalInfoPaneHeader')}
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    <div class="form-group">
                                        <label for="cid" class="col-sm-2 control-label">
                                            ${i18n.t('app.customer.customerNrLbl')}
                                        </label>
                                        <div class="col-sm-4">
                                            <p id="cid"
                                                class="form-control-static" data-bind="text: data.cid, visible: data.isValid"/>
                                        </div>
                                    </div>
                                    <hr/>
                                    <div class="form-group">
                                        <label for="name" class="col-sm-2 control-label">
                                            ${i18n.t('app.customer.nameLbl')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" id="name"
                                                class="form-control"
                                                data-bind="value: data.name"/>
                                        </div>
                                    </div>
                                    <div for(idx in [1,2,3])>
                                        <div class="form-group">
                                            <label for="addr${idx}" class="col-sm-2 control-label">
                                                ${i18n.t('app.customer.addrLbl', {nr: (idx)})}
                                            </label>
                                            <div class="col-sm-4">
                                                <input type="text"
                                                    id="addr${idx}"
                                                    class="form-control"
                                                    data-bind="value: data.addr${idx}"/>
                                            </div>
                                        </div>
                                    </div>
                                    <hr/>
                                    <div class="form-group">
                                        <label for="vatNr" class="col-sm-2 control-label">
                                            ${i18n.t('app.customer.vatNrLbl')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" id="vatNr"
                                                class="form-control"
                                                data-bind="value: data.vatNr"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">
                                        ${i18n.t('app.customer.contactInfoPaneHeader')}
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    <div class="form-group">
                                        <label for="contact" class="col-sm-2 control-label">
                                            ${i18n.t('app.customer.contactLbl')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" id="contact"
                                                class="form-control"
                                                data-bind="value: data.contact"/>
                                        </div>
                                    </div>
                                    <div for(idx in [1,2,3])>
                                        <div class="form-group">
                                            <label for="phone${idx}" class="col-sm-2 control-label">
                                                ${i18n.t('app.customer.phoneLbl', {nr: (idx)})}
                                            </label>
                                            <div class="col-sm-4">
                                                <input type="text"
                                                    id="phone${idx}"
                                                    class="form-control"
                                                    data-bind="value: data.phone${idx}"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="name" class="col-sm-2 control-label">
                                            ${i18n.t('app.customer.emailLbl')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="email" id="email"
                                                class="form-control"
                                                data-bind="value: data.email"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">
                                        ${i18n.t('app.customer.optionPaneHeader')}
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    <div class="checkbox">
                                        <label>
                                            <input type="checkbox"
                                                data-bind="checked: data.noVat" aria-label=" ${i18n.t('app.customer.optionNoVatLbl')}"/>
                                            ${i18n.t('app.customer.optionNoVatLbl')}
                                        </label>
                                    </div>
                                    <div class="checkbox">
                                        <label>
                                            <input type="checkbox" data-bind="checked: data.useReverseCharge" aria-label=" ${i18n.t('app.customer.optionUseReverseChargeLbl')}"/>
                                            ${i18n.t('app.customer.optionUseReverseChargeLbl')}
                                        </label>
                                    </div>
                                    <hr/>
                                    <div class="form-group">
                                        <label for="currencySelect" class="col-sm-2 control-label">
                                            ${i18n.t('app.currency.selectLbl')}
                                        </label>
                                        <div class="col-sm-4">
                                            <select id="currencySelect"
                                                class="form-control" data-bind="options: currencyList, optionsText: getCurrencyDesc, value: data.currency">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="invoiceLngSelect" class="col-sm-2 control-label">
                                            ${i18n.t('app.invoiceLng.selectLbl')}
                                        </label>
                                        <div class="col-sm-4">
                                            <select id="invoiceLngSelect"
                                                class="form-control" data-bind="options: invoiceLngList, optionsText: getInvoiceLngDesc, value: data.invoiceLng">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <nav>
                                <ul class="pager">
                                    <li>
                                        <a href="#" data-bind="click: toggleIsExtraOptVisible">
                                            <span data-bind="ifnot: isExtraOptVisible">
                                                <icon icon="chevron-down" extraClass="inline-icon-left-fix"/>
                                                ${i18n.t('app.customer.extraOptToggleLbl', {context: 'show'})}
                                                <icon icon="chevron-down" extraClass="inline-icon-right-fix"/>
                                            </span>
                                            <span data-bind="if: isExtraOptVisible">
                                                <icon icon="chevron-up" extraClass="inline-icon-left-fix"/>
                                                ${i18n.t('app.customer.extraOptToggleLbl', {context: 'hide'})}
                                                <icon icon="chevron-up" extraClass="inline-icon-right-fix"/>
                                            </span>
                                        </a>
                                    </li>
                                </ul>
                            </nav>


                            <div class="panel panel-default" data-bind="visible: isExtraOptVisible">
                                <div class="panel-heading">
                                    <h3 class="panel-title">
                                        ${i18n.t('app.customer.transferPaneHeader')}
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    <div class="form-group" data-bind="enable: data._id() != undefined">
                                        <label for="companySelect"
                                            class="col-md-2 control-label">

                                            ${i18n.t('app.customer.transferCompanySelectLbl')}

                                        </label>
                                        <div class="col-md-3">
                                            <select id="companySelect" class="form-control"
                                                data-bind="options: companyList, optionsText: 'name', value: transferDestCompany">
                                            </select>
                                        </div>
                                        <button type="button" class="btn btn-default"
                                            data-bind="click: transferCustomer, enable: data._id() != undefined">
                                            <icon icon="exchange" extraClass="inline-icon-left-fix"/>
                                            ${i18n.t('app.customer.transferCustomerBtn')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-success"
                                data-bind="click: saveCustomer">
                                <icon icon="save" extraClass="inline-icon-left-fix"/>
                                ${i18n.t('app.customer.saveBtn')}
                            </button>
                        </div>
                    </div>

                </div>
                <div id="app-invoices" data-bind="visible: currentView() == 'invoices' || currentView() == 'offers'" style="display: none">

                    <div class="row" data-bind="visible: isFilterPaneExpanded">
                        <div class="col-md-12">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    <form class="form-horizontal">
                                        <!-- Customer filter -->
                                        <div class="form-group form-group-sm">
                                            <label class="col-md-1 control-label" for="customerFilterCid">
                                                ${i18n.t('app.invoiceList.customerFilterLbl')}
                                            </label>
                                            <div class="col-md-3">
                                                <div class="input-group input-group-sm">
                                                    <input class="form-control" id="customerFilterCid"
                                                           data-bind="jqAuto: {
                                                                        value: filterOpt.customerFilterCustomer,
                                                                        source: customerList,
                                                                        options: {minLength: 0}
                                                                      }"/>
                                                    <div class="input-group-btn">
                                                        <button type="button" class="btn btn-default"
                                                                data-bind="click: Ui.doShowAutocompleteList.bind(null, 'input', 'id', 'customerFilterCid')">
                                                            <span class="caret"></span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Date filter -->
                                        <div class="form-group form-group-sm">
                                            <label class="col-md-1 control-label" for="dateFilterYearGrp">
                                                ${i18n.t('app.invoiceList.dateFilterYearLbl')}
                                            </label>
                                            <div class="col-md-11">
                                                <!-- Special button for selecting all years (wildcard) -->
                                                <button class="btn btn-xs" data-bind="click: setDateFilterYear.bind(null, '*'),
                                                                               css: {'btn-default': !filterOpt.dateFilterIsYearChecked('*'), 'btn-success': filterOpt.dateFilterIsYearChecked('*')}">
                                                    ${i18n.t('app.invoiceList.dateFilterWildcardText')}
                                                </button>
                                                <div class="btn-group btn-group-xs left3" role="group" id="dateFilterYearGrp">
                                                    <!-- Add more years to low end -->
                                                    <button class="btn btn-default" data-bind="click: dateFilterAddYears.bind(null, -3)">
                                                        <icon icon="chevron-left"/>
                                                    </button>
                                                    <!-- Show available years -->
                                                    <html-comment> ko foreach: dateFilterYearList </html-comment>
                                                        <button class="btn" data-bind="click: $parent.setDateFilterYear.bind(null, $data),
                                                                                       css: {'btn-default': !$parent.filterOpt.dateFilterIsYearChecked($data), 'btn-success': $parent.filterOpt.dateFilterIsYearChecked($data)},
                                                                                       text: $data">
                                                        </button>
                                                    <html-comment> /ko </html-comment>
                                                    <!-- Add more years to high end -->
                                                    <button class="btn btn-default" data-bind="click: dateFilterAddYears.bind(null, 3)">
                                                        <icon icon="chevron-right"/>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group form-group-sm">
                                            <label class="col-md-1 control-label" for="dateFilterMonthGrp">
                                                ${i18n.t('app.invoiceList.dateFilterMonthLbl')}
                                            </label>
                                            <div class="col-md-11">
                                              <div class="btn-group btn-group-xs" role="group" id="dateFilterMonthGrp">
                                                <for(var i=0; i<=11; i++)>
                                                    <button class="btn" data-bind="click: setDateFilterMonth.bind(null, ${i}),
                                                                                   css: {'btn-default': !filterOpt.dateFilterIsMonthChecked(${i}), 'btn-success': filterOpt.dateFilterIsMonthChecked(${i})},
                                                                                   text: t('app.invoiceList.dateFilterMonthLbl', {context: '${i}'})">
                                                    </button>
                                                  </for>
                                              </div>
                                            </div>
                                        </div>

                                        <div class="form-group form-group-sm">
                                            <label class="col-md-1 control-label" for="invoiceFilterCurrency">
                                                ${i18n.t('app.currency.selectLbl')}
                                            </label>
                                            <div class="col-md-3">
                                              <select id="invoiceFilterCurrency"
                                                  class="form-control" data-bind="options: currencyList, optionsText: getCurrencyDesc, value: filterOpt.currencyFilter">


                                              </select>
                                            </div>
                                        </div>

                                        <!-- Show filters -->
                                        <div class="form-group form-group-sm">
                                            <label class="col-md-1 control-label" for="invoiceOptFilter">
                                                ${i18n.t('app.invoiceList.propFilterLbl')}
                                            </label>
                                            <div id="invoiceOptFilter" data-bind="if: docType() == 'invoice'">
                                              <div class="col-md-11">
                                                  <filterLabelToggle condVar="filterOpt.showNotCredit" text="${i18n.t('app.invoiceList.showNotCreditFilterLbl')}"/>
                                                  <filterLabelToggle condVar="filterOpt.showCredit" text="${i18n.t('app.invoiceList.showCreditFilterLbl')}"/>
                                              </div>
                                              <div class="col-md-offset-1 col-md-11">
                                                  <filterLabelToggle condVar="filterOpt.showPaid" text="${i18n.t('app.invoiceList.showPaidFilterLbl')}"/>
                                                  <filterLabelToggle condVar="filterOpt.showUnpaid" text="${i18n.t('app.invoiceList.showUnpaidFilterLbl')}"/>
                                                  <filterLabelToggle condVar="filterOpt.showUnpaidExpired" text="${i18n.t('app.invoiceList.showUnpaidExpiredFilterLbl')}"/>
                                              </div>
                                              <div class="col-md-offset-1 col-md-11">
                                                  <filterLabelToggle condVar="filterOpt.showNotCanceled" text="${i18n.t('app.invoiceList.showNotCanceledFilterLbl')}"/>
                                                  <filterLabelToggle condVar="filterOpt.showCanceled" text="${i18n.t('app.invoiceList.showCanceledFilterLbl')}"/>
                                              </div>
                                            </div>
                                            <div id="invoiceOptFilter" data-bind="if: docType() == 'offer'">
                                              <div class="col-md-11">
                                                  <filterLabelToggle condVar="filterOpt.showNotCanceled" text="${i18n.t('app.invoiceList.showNotCanceledFilterLbl')}"/>
                                                  <filterLabelToggle condVar="filterOpt.showCanceled" text="${i18n.t('app.invoiceList.showCanceledFilterLbl')}"/>
                                              </div>
                                            </div>
                                        </div>
                                   </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <nav>
                        <ul class="pager top0 bottom0">
                            <li>
                                <a href="#" data-bind="click: doToggleFilterPaneExpanded">
                                    <span data-bind="ifnot: isFilterPaneExpanded">
                                        <icon icon="chevron-down" extraClass="inline-icon-left-fix"/>
                                        ${i18n.t('app.invoiceList.filterPaneToggleLbl', {context: 'show'})}
                                        <icon icon="chevron-down" extraClass="inline-icon-right-fix"/>
                                    </span>
                                    <span data-bind="if: isFilterPaneExpanded">
                                        <icon icon="chevron-up" extraClass="inline-icon-left-fix"/>
                                        ${i18n.t('app.invoiceList.filterPaneToggleLbl', {context: 'hide'})}
                                        <icon icon="chevron-up" extraClass="inline-icon-right-fix"/>
                                    </span>
                                </a>
                            </li>
                        </ul>
                    </nav>

                    <form>
                        <p>
                            <table class="table table-striped table-condensed">
                                <colgroup>
                                    <!-- Controls -->
                                    <col class="col-md-1"/>
                                    <!-- Nr -->
                                    <col class="col-md-1"/>
                                    <!-- Date -->
                                    <col class="col-md-1"/>
                                    <!-- Customer nr -->
                                    <col class="col-md-1"/>
                                    <!-- Customer name -->
                                    <col class="col-md-2"/>
                                    <!-- Currency -->
                                    <col class="col-md-1"/>
                                    <!-- Total excl VAT -->
                                    <col class="col-md-2"/>
                                    <!-- Total VAT -->
                                    <col class="col-md-2"/>
                                    <!-- isPaid -->
                                    <col class="col-md-1"/>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th/>
                                        <th>
                                            ${i18n.t('app.invoiceList.colNr')}
                                            <button type="button" class="btn btn-default btn-xs"
                                                data-bind="click: doSortToggle('docNr')">
                                                <condIcon cond="invoiceListSort() !== 'docNrAsc'" icon="sort-amount-asc"/>
                                                <condIcon cond="invoiceListSort() === 'docNrAsc'" icon="sort-amount-desc"/>
                                            </button>
                                        </th>
                                        <th>
                                            ${i18n.t('app.invoiceList.colDate')}
                                            <button type="button" class="btn btn-default btn-xs"
                                                data-bind="click: doSortToggle('date')">
                                                <condIcon cond="invoiceListSort() !== 'dateAsc'" icon="sort-amount-asc"/>
                                                <condIcon cond="invoiceListSort() === 'dateAsc'" icon="sort-amount-desc"/>
                                            </button>
                                        </th>
                                        <th>
                                            ${i18n.t('app.invoiceList.colCustomerNr')}
                                            <button type="button" class="btn btn-default btn-xs"
                                                data-bind="click: doSortToggle('cid')">
                                                <condIcon cond="invoiceListSort() !== 'cidAsc'" icon="sort-amount-asc"/>
                                                <condIcon cond="invoiceListSort() === 'cidAsc'" icon="sort-amount-desc"/>
                                            </button>
                                        </th>
                                        <th>
                                            ${i18n.t('app.invoiceList.colCustomerName')}
                                            <button type="button"
                                                class="btn btn-default btn-xs" data-bind="click: doSortToggle('customer')">
                                                <condIcon cond="invoiceListSort() !== 'customerAsc'" icon="sort-amount-asc"/>
                                                <condIcon cond="invoiceListSort() === 'customerAsc'" icon="sort-amount-desc"/>
                                            </button>
                                        </th>
                                        <th>
                                            ${i18n.t('app.invoiceList.colCurrency')}
                                            <button type="button"
                                                class="btn btn-default btn-xs" data-bind="click: doSortToggle('currency')">
                                                <condIcon cond="invoiceListSort() !== 'currencyAsc'" icon="sort-amount-asc"/>
                                                <condIcon cond="invoiceListSort() === 'currencyAsc'" icon="sort-amount-desc"/>
                                            </button>
                                        </th>
                                        <th>
                                            ${i18n.t('app.invoiceList.colTotalExclVat')}
                                            <button type="button"
                                                class="btn btn-default btn-xs" data-bind="click: doSortToggle('totalExclVat')">
                                                <condIcon cond="invoiceListSort() !== 'totalExclVatAsc'" icon="sort-amount-asc"/>
                                                <condIcon cond="invoiceListSort() === 'totalExclVatAsc'" icon="sort-amount-desc"/>
                                            </button>
                                        </th>
                                        <th>
                                            ${i18n.t('app.invoiceList.colTotalVat')}
                                            <button type="button"
                                                class="btn btn-default btn-xs" data-bind="click: doSortToggle('totalVat')">
                                                <condIcon cond="invoiceListSort() !== 'totalVatAsc'" icon="sort-amount-asc"/>
                                                <condIcon cond="invoiceListSort() === 'totalVatAsc'" icon="sort-amount-desc"/>
                                            </button>
                                        </th>
                                        <th data-bind="if: docType() == 'invoice'">
                                            ${i18n.t('app.invoiceList.colIsPaid')}
                                        </th>
                                    </tr>
                                </thead>
                                <tbody data-bind="foreach: docList()">
                                    <tr data-bind="if: isVisible(), css: { danger: isExpired }">
                                        <td>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <a class="btn btn-info" data-bind="attr: { href: '#/page/' + docType() + '_show/' + _id() }">
                                                    <icon icon="pencil"/>
                                                </a>
                                                <a class="btn btn-info" data-bind="click: printDoc">
                                                    <icon icon="print"/>
                                                </a>
                                            </div>
                                        </td>
                                        <td>
                                            <p class="form-control-static">
                                                <span class="right3" data-bind="text: docNr"/>
                                                <condLockIcon cond="isLocked" tooltip="${i18n.t('app.invoiceList.isLockedIconTooltip')}"/>
                                                <condIcon cond="isCredit" icon="credit-card" tooltip="${i18n.t('app.invoiceList.isCreditIconTooltip')}"/>
                                                <condIcon cond="isCanceled" icon="remove" tooltip="${i18n.t('app.invoiceList.isCanceledIconTooltip')}"/>
                                                <condIcon cond="isExpired" icon="warning" tooltip="${i18n.t('app.invoiceList.isExpiredIconTooltip')}"/>
                                            </p>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: date"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: customer().cid"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: customer().name"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: currency"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: totalExclVatStr"/>
                                        </td>
                                        <td>
                                            <p class="form-control-static" data-bind="text: totalVatStr"/>
                                        </td>
                                        <td data-bind="if: docType() == 'invoice'">
                                            <p class="form-control-static">
                                                <condCheckIcon cond="isPaid"/>
                                            </p>
                                        </td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="5">
                                            <p class="form-control-static" data-bind="text: numInvoicesText"></p>
                                        </td>
                                        <td>
                                            <p class="form-control-static">
                                                <html-comment> ko foreach: totalPerCurrencyText </html-comment>
                                                    <span data-bind="text: currency"></span><br/>
                                                <html-comment> /ko </html-comment>
                                            </p>
                                        </td>
                                        <td>
                                            <p class="form-control-static">
                                                <html-comment> ko foreach: totalPerCurrencyText </html-comment>
                                                    <span data-bind="text: sumExclVatStr"></span><br/>
                                                <html-comment> /ko </html-comment>
                                            </p>
                                        </td>
                                        <td>
                                            <p class="form-control-static">
                                                <html-comment> ko foreach: totalPerCurrencyText </html-comment>
                                                    <span data-bind="text: sumVatStr"></span><br/>
                                                <html-comment> /ko </html-comment>
                                              </p>
                                        </td>
                                        <td data-bind="if: docType() == 'invoice'"></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </p>
                        <div class="btn-group" role="group">
                            <html-comment> ko if: docType() == 'invoice' </html-comment>
                                <a href="#/page/invoice_new" type="button" class="btn btn-success">
                                    <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                    ${i18n.t('app.invoiceList.newDocBtn', {context: 'invoice'})}
                                </a>
                            <html-comment> /ko </html-comment>
                            <html-comment> ko if: docType() == 'offer' </html-comment>
                                <a href="#/page/offer_new" type="button" class="btn btn-success">
                                    <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                    ${i18n.t('app.invoiceList.newDocBtn', {context: 'offer'})}
                                </a>
                            <html-comment> /ko </html-comment>
                        </div>
                    </form>

                </div>

                <div id="app-invoice_new" data-bind="visible: currentView() == 'invoice_new' || (currentView() != undefined && currentView().search('invoice_show') == 0) ||
                                                              currentView() == 'offer_new' || (currentView() != undefined && currentView().search('offer_show') == 0)"
                    style="display: none">

                    <macro labelWithEditMode(textVariable, cond)>
                        <span data-bind="ifnot: ${cond}">
                            <span data-bind="text: ${textVariable}"/>
                        </span>
                        <span data-bind="if: ${cond}">
                            <input type="text" class="form-control"
                                data-bind="value: ${textVariable}"/>
                        </span>
                    </macro>
                    <macro labelWithEditModeCondensed(textVariable, cond)>
                        <span data-bind="ifnot: ${cond}">
                            <span class="form-control-static"
                                data-bind="text: ${textVariable}"/>
                        </span>
                        <span data-bind="if: ${cond}">
                            <input type="text" class="form-control input-sm"
                                data-bind="value: ${textVariable}"/>
                        </span>
                    </macro>
                    <div class="row">
                        <!-- top panel -->
                        <div class="col-md-8">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">
                                        <span data-bind="if: isInvoice">
                                            <span data-bind="if: data.docNr() === undefined && !data.isCredit()">
                                                ${i18n.t('app.invoice.mainPanelHeader', {context: 'newInvoice'})}
                                            </span>
                                            <span data-bind="if: data.docNr() === undefined && data.isCredit()">
                                                ${i18n.t('app.invoice.mainPanelHeader', {context: 'newCreditInvoice'})}
                                            </span>
                                            <span data-bind="if: data.docNr() != undefined && !data.isCredit()">
                                                ${i18n.t('app.invoice.mainPanelHeader', {context: 'invoice'})}
                                                &nbsp;
                                                <span data-bind="text: data.docNr"/>
                                            </span>
                                            <span data-bind="if: data.docNr() != undefined && data.isCredit()">
                                                ${i18n.t('app.invoice.mainPanelHeader', {context: 'creditInvoice'})}
                                                &nbsp;
                                                <span data-bind="text: data.docNr"/>
                                            </span>
                                        </span>
                                        <span data-bind="if: isOffer">
                                            <span data-bind="if: data.docNr() === undefined">
                                                ${i18n.t('app.invoice.mainPanelHeader', {context: 'newOffer'})}
                                            </span>
                                            <span data-bind="if: data.docNr() !== undefined">
                                                ${i18n.t('app.invoice.mainPanelHeader', {context: 'offer'})}
                                                &nbsp;
                                                <span data-bind="text: data.docNr"/>
                                            </span>
                                        </span>
                                        <condLockIcon cond="data.isLocked"/>
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <label for="invoiceNewCustomerId"
                                                    class="control-label">
                                                    ${i18n.t('app.invoice.customerLbl')}
                                                </label>
                                                <div class="input-group">
                                                    <input class="form-control" id="invoiceNewCustomerId"
                                                           data-bind="jqAuto: {
                                                                        value: selectedCustomer,
                                                                        source: customerList,
                                                                        options: {minLength: 0}
                                                                      },
                                                                      disable: data.isLocked"/>
                                                    <div class="input-group-btn">
                                                        <button type="button" class="btn btn-default"
                                                                data-bind="click: Ui.doShowAutocompleteList.bind(null, 'input', 'id', 'invoiceNewCustomerId'),
                                                                           disable: data.isLocked">
                                                            <span class="caret"></span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <label for="date" class="control-label"
                                                       data-bind="text: t('app.invoice.dateLbl', {context: data.docType()})">
                                                </label>
                                                <input type="date" class="form-control"
                                                    id="date" data-bind="value: data.date, disable: data.isLocked"/>
                                            </div>
                                        </div>
                                        <div class="col-md-4" data-bind="if: isInvoice">
                                            <div class="input-group">
                                                <label for="daysUntilPayment" class="control-label">
                                                    ${i18n.t('app.invoice.daysUntilPayLbl')}
                                                </label>
                                                <input type="number"
                                                    class="form-control"
                                                    id="daysUntilPayment" data-bind="value: data.daysUntilPayment, disable: data.isLocked"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <label for="yourReference" class="control-label">
                                                    ${i18n.t('app.invoice.yourRefLbl')}
                                                </label>
                                                <input type="text"
                                                    class="form-control"
                                                    id="yourReference" data-bind="value: data.yourRef, disable: data.isLocked"/>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <label for="ourReference" class="control-label">
                                                    ${i18n.t('app.invoice.ourRefLbl')}
                                                </label>
                                                <input type="text"
                                                    class="form-control"
                                                    id="ourReference" data-bind="value: data.ourRef, disable: data.isLocked"/>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <label for="projectId" class="control-label">
                                                    ${i18n.t('app.invoice.projIdLbl')}
                                                </label>
                                                <input type="text"
                                                    class="form-control"
                                                    id="projectId" data-bind="value: data.projId, disable: data.isLocked"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="panel" data-bind="css: {'panel-default': !data.customerAddrIsEditMode(), 'panel-warning': data.customerAddrIsEditMode}">
                                <div class="panel-heading invoice-customer-addr-panel-heading">
                                    <div class="row">
                                        <div class="col-md-10">
                                            <p class="form-control-static panel-title">
                                                ${i18n.t('app.invoice.customerDetailsPaneHeader')}
                                            </p>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="pull-right">
                                                <button class="btn btn-sm top0 bottom0" data-bind="click: data.toggleCustomerAddrEditMode,
                                                                                                   css: {'btn-default': !data.customerAddrIsEditMode(), 'btn-success': data.customerAddrIsEditMode},
                                                                                                   disable: data.isLocked() || data.customer() === undefined">
                                                    <div data-bind="ifnot: data.customerAddrIsEditMode">
                                                        <icon icon="pencil"/>
                                                    </div>
                                                    <div data-bind="if: data.customerAddrIsEditMode">
                                                        <icon icon="check"/>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <form class="form-horizontal"
                                        data-bind="if: data.customer() !== undefined">

                                        <div class="col-md-12">
                                            <div class="row">
                                                <p class="form-control-static">
                                                    ${i18n.t('app.invoice.customerDetailsCustomerNrLbl')}
                                                    &nbsp;
                                                    <span data-bind="text: data.customer().cid"/>
                                                </p>
                                            </div>
                                            <div class="row">
                                                <strong>
                                                    <span data-bind="text: data.customerMirror_name"/>
                                                </strong>
                                                <br/>
                                            </div>
                                            <div class="row">
                                                <labelWithEditModeCondensed textVariable="data.customerMirror_addr1"
                                                    cond="data.customerAddrIsEditMode"/>
                                            </div>
                                            <div class="row">
                                                <labelWithEditModeCondensed textVariable="data.customerMirror_addr2"
                                                    cond="data.customerAddrIsEditMode"/>
                                            </div>
                                            <div class="row">
                                                <labelWithEditModeCondensed textVariable="data.customerMirror_addr3"
                                                    cond="data.customerAddrIsEditMode"/>
                                            </div>
                                        </div>

                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- top panel -->
                    <div class="row">
                        <!-- invoice items panel -->
                        <div class="col-md-12">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    <html-comment>
                                        ko foreach: data.invoiceItemGroups
                                    </html-comment>
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="panel" data-bind="css: {'panel-default': !isEditMode(), 'panel-warning': isEditMode}">
                                                <div class="panel-heading invoice-item-group-panel-heading">
                                                    <div class="row">
                                                        <span data-bind="ifnot: isEditMode">
                                                            <span class="col-md-7">
                                                                <div class="form-inline">
                                                                    <div class="form-group">
                                                                        <p class="form-control-static panel-title">
                                                                            <span data-bind="text: title"/>
                                                                        </p>
                                                                        <span data-bind="if: hasTitleExtraField">
                                                                            &nbsp;
                                                                            <input type="text" class="form-control" data-bind="value: titleExtraField"/>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </span>
                                                        </span>
                                                        <span data-bind="if: isEditMode">
                                                            <span class="col-md-5">
                                                                <input type="text" class="form-control" data-bind="value: title"/>
                                                            </span>
                                                            <span class="col-md-2">
                                                                <input type="text" class="form-control input-sm" data-bind="value: name"
                                                                    id="grpNameInput"/>
                                                            </span>
                                                        </span>
                                                        <span class="col-md-5">
                                                            <span class="pull-right">
                                                                <span data-bind="ifnot: isEditMode">
                                                                    <span class="label label-default label-fix" data-bind="text: name"/>
                                                                    <!-- <span class="label label-default label-fix" data-bind="text: numInvoiceItemsText"></span> -->
                                                                </span>
                                                                <span data-bind="if: isEditMode">
                                                                    <div class="btn-group"
                                                                        role="group">

                                                                        <button type="button" class="btn btn-default btn-sm" data-bind="click: updateServerForceNew, disable: $parent.data.isLocked">
                                                                            <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                                                            ${i18n.t('app.invoice.groupEditSaveAsNewBtn')}
                                                                        </button>
                                                                        <button type="button" class="btn btn-default btn-sm dropdown-toggle right5" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-bind="disable: $parent.data.isLocked">
                                                                            <span class="caret"/>
                                                                        </button>
                                                                        <ul class="dropdown-menu">
                                                                            <li>
                                                                                <a href="#" data-bind="click: updateServer">
                                                                                    <icon icon="save" extraClass="inline-icon-left-fix"/>
                                                                                    ${i18n.t('app.invoice.groupEditUpdateExistingBtn')}
                                                                                </a>
                                                                            </li>
                                                                        </ul>

                                                                    </div>
                                                                </span>
                                                                <button class="btn right3" data-bind="click: toggleEditMode,
                                                                                                      css: {'btn-default': !isEditMode(), 'btn-success': isEditMode},
                                                                                                      disable: $parent.data.isLocked">
                                                                    <div data-bind="ifnot: isEditMode">
                                                                        <icon icon="pencil"/>
                                                                    </div>
                                                                    <div data-bind="if: isEditMode">
                                                                        <icon icon="check"/>
                                                                    </div>
                                                                </button>
                                                                <button class="btn btn-danger right5" data-bind="click: $parent.data.deleteGroup, disable: $parent.data.isLocked">
                                                                    <icon icon="trash"/>
                                                                </button>
                                                                <div class="btn-group-vertical top0 bottom0" role="group">

                                                                    <button class="btn btn-default btn-xs" data-bind="click: $parent.data.moveGroupUp, disable: $parent.data.isLocked">
                                                                        <icon icon="arrow-up"/>
                                                                    </button>
                                                                    <button class="btn btn-default btn-xs" data-bind="click: $parent.data.moveGroupDown, disable: $parent.data.isLocked">
                                                                        <icon icon="arrow-down"/>
                                                                    </button>
                                                                </div>
                                                            </span>
                                                        </span>
                                                    </div>
                                                    <div data-bind="if: isEditMode">
                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <div class="checkbox input-sm bottom0 top0">
                                                                    <label>
                                                                        <input type="checkbox" data-bind="checked: isQuickButton"/>
                                                                        ${i18n.t('app.invoice.groupEditIsQuickButtonCheckLbl')}
                                                                    </label>
                                                                </div>
                                                                <div class="checkbox input-sm bottom0 top0">
                                                                    <label>
                                                                        <input type="checkbox" data-bind="checked: hasTitleExtraField"/>
                                                                        ${i18n.t('app.invoice.groupEditHasTitleExtraFieldCheckLbl')}
                                                                    </label>
                                                                </div>
                                                                <div class="checkbox input-sm bottom0 top0">
                                                                    <label>
                                                                        <input type="checkbox" data-bind="checked: isTextOnlyDefault"/>
                                                                        ${i18n.t('app.invoice.groupEditIsTextOnlyDefaultCheckLbl')}
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <table class="table table-striped table-condensed">
                                                    <colgroup>
                                                        <col class="col-md-2"/>
                                                        <col class="col-md-3"/>
                                                        <col class="col-md-1"/>
                                                        <col class="col-md-2"/>
                                                        <col class="col-md-1"/>
                                                        <col class="col-md-1"/>
                                                        <col class="col-md-2"/>
                                                    </colgroup>
                                                    <thead>
                                                        <tr>
                                                            <th style="vertical-align:top">
                                                            </th>
                                                            <th style="vertical-align:top">
                                                                <div data-bind="if: isEditMode">
                                                                    <div class="checkbox input-sm">
                                                                        <label>
                                                                            <input type="checkbox" data-bind="checked: hasDesc"/>
                                                                            ${i18n.t('app.invoice.groupEditColActiveCheckLbl')}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <html-comment>
                                                                    ko if: hasDesc
                                                                </html-comment>
                                                                <labelWithEditMode textVariable="descColLbl"
                                                                    cond="isEditMode"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </th>
                                                            <th style="vertical-align:top">
                                                                <div data-bind="if: isEditMode">
                                                                    <div class="checkbox input-sm">
                                                                        <label>
                                                                            <input type="checkbox" data-bind="checked: hasCount"/>
                                                                            ${i18n.t('app.invoice.groupEditColActiveCheckLbl')}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <html-comment>
                                                                    ko if: hasCount
                                                                </html-comment>
                                                                <labelWithEditMode textVariable="countColLbl"
                                                                    cond="isEditMode"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </th>
                                                            <th style="vertical-align:top">
                                                                <div data-bind="if: isEditMode">
                                                                    <div class="checkbox input-sm">
                                                                        <label>
                                                                            <input type="checkbox" data-bind="checked: hasPrice"/>
                                                                            ${i18n.t('app.invoice.groupEditColActiveCheckLbl')}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <html-comment>
                                                                    ko if: hasPrice
                                                                </html-comment>
                                                                <labelWithEditMode textVariable="priceColLbl"
                                                                    cond="isEditMode"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </th>
                                                            <th style="vertical-align:top">
                                                                <div data-bind="if: isEditMode">
                                                                    <div class="checkbox input-sm">
                                                                        <label>
                                                                            <input type="checkbox" data-bind="checked: hasDiscount"/>
                                                                            ${i18n.t('app.invoice.groupEditColActiveCheckLbl')}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <html-comment>
                                                                    ko if: hasDiscount
                                                                </html-comment>
                                                                <labelWithEditMode textVariable="discountColLbl"
                                                                    cond="isEditMode"/>
                                                                <div data-bind="if: isEditMode">
                                                                    <div class="checkbox input-sm">
                                                                        <label>
                                                                            <input type="checkbox" data-bind="checked: negateDiscount"/>
                                                                            ${i18n.t('app.invoice.groupEditNegateDiscountCheckLbl')}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </th>
                                                            <th style="vertical-align:top">
                                                                <div data-bind="if: isEditMode">
                                                                    <div class="checkbox input-sm">
                                                                        <label>
                                                                            <input type="checkbox" data-bind="checked: hasVat"/>
                                                                            ${i18n.t('app.invoice.groupEditColActiveCheckLbl')}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <html-comment>
                                                                    ko if: hasVat
                                                                </html-comment>
                                                                <span data-bind="ifnot: isEditMode">
                                                                    <span data-bind="text: vatColLbl, css: {'text-muted': !$parent.data.hasVat()}"/>
                                                                </span>
                                                                <span data-bind="if: isEditMode">
                                                                    <input type="text" class="form-control" data-bind="value: vatColLbl"/>
                                                                </span>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </th>
                                                            <th style="vertical-align:top;text-align:right">
                                                                <div data-bind="if: isEditMode">
                                                                    <div class="checkbox input-sm">
                                                                        <label>
                                                                            <input type="checkbox" data-bind="checked: hasTotal"/>
                                                                            ${i18n.t('app.invoice.groupEditColActiveCheckLbl')}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <html-comment>
                                                                    ko if: hasTotal
                                                                </html-comment>
                                                                <labelWithEditMode textVariable="totalColLbl"
                                                                    cond="isEditMode"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody data-bind="foreach: invoiceItems">
                                                        <tr>
                                                            <td>
                                                                <div class="form-inline">
                                                                    <div class="form-group">
                                                                        <button class="btn btn-danger btn-sm" data-bind="click: $parent.deleteInvoiceItem, disable: $parents[1].data.isLocked">
                                                                            <icon icon="trash"/>
                                                                        </button>
                                                                        <div class="checkbox input-sm">
                                                                            <label>
                                                                                <input type="checkbox" data-bind="checked: isTextOnly, disable: $parents[1].data.isLocked"/>
                                                                                ${i18n.t('app.invoice.detailsIsTextOnlyCheckLbl')}
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td data-bind="attr: {colspan: descriptionColspan}">
                                                                <html-comment>
                                                                    ko if: hasDesc
                                                                </html-comment>
                                                                <div class="input-group" style="width: 100%;">
                                                                    <textarea class="form-control"
                                                                              data-bind="attr: {
                                                                                           rows: descriptionNumRows,
                                                                                           name: 'itemDescAutocomplete_' + $parentContext.$index() + '_' + $index()
                                                                                         },
                                                                                         jqAuto: {
                                                                                           value: description,
                                                                                           inputProp: 'value',
                                                                                           valueProp: 'value',
                                                                                           labelProp: 'label',
                                                                                           dataValue: selectedArticle,
                                                                                           source: $parents[1].searchArticleList.bind(null, $parents[0]._id()),
                                                                                           options: {minLength: 0}
                                                                                         },
                                                                                         disable: $parents[1].data.isLocked"/>
                                                                    <div class="input-group-btn">
                                                                        <button type="button" class="btn btn-default"
                                                                                data-bind="click: Ui.doShowAutocompleteList.bind(null, 'textarea', 'name', 'itemDescAutocomplete_' + $parentContext.$index() + '_' + $index()),
                                                                                           disable: $parents[1].data.isLocked">
                                                                            <span class="caret"></span>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </td>
                                                            <html-comment>
                                                                ko if: descriptionColspan() < 2
                                                            </html-comment>
                                                            <td>
                                                                <html-comment>
                                                                    ko if: hasCount
                                                                </html-comment>
                                                                <input type="number" class="form-control" data-bind="textInput: count, disable: $parents[1].data.isLocked"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </td>
                                                            <html-comment>
                                                                /ko
                                                            </html-comment>
                                                            <html-comment>
                                                                ko if: descriptionColspan() < 3
                                                            </html-comment>
                                                            <td>
                                                                <html-comment>
                                                                    ko if: hasPrice
                                                                </html-comment>
                                                                <input type="number" class="form-control" data-bind="textInput: price, disable: $parents[1].data.isLocked"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </td>
                                                            <html-comment>
                                                                /ko
                                                            </html-comment>
                                                            <html-comment>
                                                                ko if: descriptionColspan() < 4
                                                            </html-comment>
                                                            <td>
                                                                <html-comment>
                                                                    ko if: hasDiscount
                                                                </html-comment>
                                                                <input type="number" class="form-control" data-bind="textInput: discount, disable: $parents[1].data.isLocked"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </td>
                                                            <html-comment>
                                                                /ko
                                                            </html-comment>
                                                            <html-comment>
                                                                ko if: descriptionColspan() < 5
                                                            </html-comment>
                                                            <td>
                                                                <html-comment>
                                                                    ko if: hasVat
                                                                </html-comment>
                                                                <input type="number" class="form-control" data-bind="textInput: vat, disable: $parents[1].data.isLocked() || !$parents[1].data.hasVat()"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </td>
                                                            <html-comment>
                                                                /ko
                                                            </html-comment>
                                                            <html-comment>
                                                                ko if: descriptionColspan() < 6
                                                            </html-comment>
                                                            <td>
                                                                <html-comment>
                                                                    ko if: hasTotal
                                                                </html-comment>
                                                                <p class="form-control-static text-right" data-bind="text: totalStr"/>
                                                                <html-comment>
                                                                    /ko
                                                                </html-comment>
                                                            </td>
                                                            <html-comment>
                                                                /ko
                                                            </html-comment>
                                                        </tr>
                                                    </tbody>
                                                    <tfoot>
                                                        <td colspan="3">
                                                            <button class="btn btn-success" data-bind="click: newInvoiceItem, disable: $parent.data.isLocked">
                                                                <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                                                ${i18n.t('app.invoice.detailsNewRowBtn')}
                                                            </button>
                                                        </td>
                                                        <td colspan="3">
                                                            <p class="form-control-static text-right">
                                                                ${i18n.t('app.invoice.groupTotalExclVatLbl')}
                                                            </p>
                                                        </td>
                                                        <td>
                                                            <p class="form-control-static text-right">
                                                                <span data-bind="text: totalExclVatStr"/>
                                                            </p>
                                                        </td>
                                                    </tfoot>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <html-comment> /ko </html-comment>
                                    <div class="row">
                                        <!-- invoice group summary and controls -->
                                        <div class="col-md-6">
                                            <div class="btn-group" role="group">
                                                <html-comment>
                                                    ko foreach: itemGroupList
                                                </html-comment>
                                                <html-comment>
                                                    ko if: isQuickButton
                                                </html-comment>
                                                <button type="button"
                                                    class="btn btn-primary" data-bind="click: $parent.newGroup.bind($data), disable: $parent.data.isLocked">

                                                    <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                                    <span data-bind="text: name"/>
                                                </button>
                                                <html-comment>
                                                    /ko
                                                </html-comment>
                                                <html-comment>
                                                    /ko
                                                </html-comment>
                                                <div class="btn-group">
                                                    <button type="button" class="btn btn-primary dropdown-toggle"
                                                        data-toggle="dropdown"
                                                        aria-haspopup="true"
                                                        aria-expanded="false" data-bind="disable: data.isLocked">

                                                        <span class="caret"/>

                                                    </button>
                                                    <ul class="dropdown-menu" data-bind="foreach: itemGroupList">
                                                        <html-comment>
                                                            ko ifnot: isQuickButton
                                                        </html-comment>
                                                        <li>
                                                            <a href="#" data-bind="click: $parent.newGroup.bind($data)">
                                                                <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                                                <span data-bind="text: name"/>
                                                            </a>
                                                        </li>
                                                        <html-comment>
                                                            /ko
                                                        </html-comment>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <p class="form-control-static text-right invoice-summary-labels">
                                                ${i18n.t('app.invoice.totalExclVatLbl')}
                                                <br/>
                                                <html-comment>
                                                    ko if: data.hasVat
                                                </html-comment>
                                                <strong>
                                                    ${i18n.t('app.invoice.totalInclVatLbl')}
                                                </strong>
                                                <html-comment>
                                                    /ko
                                                </html-comment>
                                            </p>
                                        </div>
                                        <div class="col-md-2">
                                            <p class="form-control-static text-right invoice-summary-labels">
                                                <span data-bind="text: data.totalExclVatStr"/>
                                                <br/>
                                                <html-comment>
                                                    ko if: data.hasVat
                                                </html-comment>
                                                <strong>
                                                    <span data-bind="text: data.totalInclVatStr"/>
                                                </strong>
                                                <html-comment>
                                                    /ko
                                                </html-comment>
                                            </p>
                                        </div>
                                    </div>
                                    <!-- invoice group summary and controls -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- invoice items panel -->
                    <nav>
                        <ul class="pager top0">
                            <li>
                                <a href="#" data-bind="click: data.toggleExtraOptionExpanded,
                                                       disable: data.isLocked">
                                    <span data-bind="ifnot: data.extraOptionExpanded">
                                        <icon icon="chevron-down" extraClass="inline-icon-left-fix"/>
                                        ${i18n.t('app.invoice.extraOptToggleLbl', {context: 'show'})}
                                        <icon icon="chevron-down" extraClass="inline-icon-right-fix"/>
                                    </span>
                                    <span data-bind="if: data.extraOptionExpanded">
                                        <icon icon="chevron-up" extraClass="inline-icon-left-fix"/>
                                        ${i18n.t('app.invoice.extraOptToggleLbl', {context: 'hide'})}
                                        <icon icon="chevron-up" extraClass="inline-icon-right-fix"/>
                                    </span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                    <div class="row"
                        data-bind="visible: data.extraOptionExpanded">

                        <!-- checkbox panel -->
                        <div class="col-md-12">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="checkbox top0" data-bind="if: isInvoice">
                                                <label>
                                                    <input type="checkbox" value data-bind="checked: data.isCredit, disable: data.isLocked"/>
                                                    ${i18n.t('app.invoice.optIsCreditLbl')}
                                                </label>
                                            </div>
                                            <div class="checkbox">
                                                <label>
                                                    <input type="checkbox" value data-bind="checked: data.isCanceled, disable: data.isLocked"/>
                                                    ${i18n.t('app.invoice.optIsCanceledLbl')}
                                                </label>
                                            </div>
                                            <div class="checkbox bottom0" data-bind="if: isInvoice">
                                                <label>
                                                    <input type="checkbox" data-bind="checked: data.isPaid"/>
                                                    ${i18n.t('app.invoice.optIsPaidLbl')}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <hr/>
                                        <h3>
                                            ${i18n.t('app.invoice.extraOptCustomerHeader')}
                                        </h3>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="checkbox top0">
                                                    <label>
                                                        <input type="checkbox" data-bind="checked: data.customerMirror_noVat, disable: data.isLocked() || data.customer() === undefined"/>
                                                        ${i18n.t('app.invoice.optNoVatLbl')}
                                                    </label>
                                                </div>
                                                <div class="checkbox" data-bind="if: isInvoice">
                                                    <label>
                                                        <input type="checkbox" data-bind="checked: data.customerMirror_useReverseCharge, disable: data.isLocked() || data.customer() === undefined"/>
                                                        ${i18n.t('app.invoice.optUseReverseChargeLbl')}
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row top5">
                                            <div class="form-group">
                                                <label for="invoiceCurrencySelect" class="col-sm-2 control-label">
                                                    ${i18n.t('app.currency.selectLbl')}
                                                </label>
                                                <div class="col-sm-4">
                                                    <select id="invoiceCurrencySelect"
                                                        class="form-control" data-bind="options: currencyList, optionsText: getCurrencyDesc, value: data.customerMirror_currency, disable: data.isLocked() || data.customer() === undefined">
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row top5">
                                            <div class="form-group">
                                                <label for="invoiceLngSelect" class="col-sm-2 control-label"
                                                       data-bind="text: t('app.invoiceLng.selectLbl', {context: data.docType()})">
                                                </label>
                                                <div class="col-sm-4">
                                                    <select id="invoiceLngSelect"
                                                        class="form-control" data-bind="options: invoiceLngList, optionsText: getInvoiceLngDesc, value: data.customerMirror_invoiceLng, disable: data.isLocked() || data.customer() === undefined">
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <hr/>
                                        <h3>
                                            ${i18n.t('app.invoice.extraOptCompanyHeader')}
                                        </h3>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <button class="btn btn-info" data-bind="click: refreshCompanyData, disable: data.isLocked">
                                                    <icon icon="refresh" extraClass="inline-icon-left-fix"/>
                                                    <span data-bind="text: t('app.invoice.refreshCompanyDataBtn', {context: data.docType()})"></span>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="row top5">
                                            <div class="form-group">
                                                <label for="invoiceStyleSelect" class="col-sm-2 control-label"
                                                       data-bind="text: t('app.invoiceStyle.selectLbl', {context: data.docType()})">
                                                </label>
                                                <div class="col-sm-4">
                                                    <select id="invoiceStyleSelect"
                                                        class="form-control" data-bind="options: invoiceStyleList, optionsText: getInvoiceStyleDesc, value: data.companyMirror_invoiceStyle, disable: data.isLocked">
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row top10">
                                            <div class="col-md-2">
                                                <label class="control-label">
                                                    ${i18n.t('app.company.paymentOptCaptionHeader')}
                                                </label>
                                            </div>
                                            <div class="col-md-3">
                                                <label class="control-label">
                                                    ${i18n.t('app.company.paymentOptInfoHeader')}
                                                </label>
                                            </div>
                                            <div class="col-md-3">
                                                <label class="control-label">
                                                    ${i18n.t('app.company.paymentOptFocusHeader')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="row top5" for(idx in [1,2,3])>
                                            <div class="col-sm-2">
                                                <input type="text"
                                                    id="pay${idx}Cap"
                                                    class="form-control" data-bind="value: data.companyLngMirror_payment${idx}Caption, disable: data.isLocked"/>
                                            </div>
                                            <div class="col-sm-3">
                                                <input type="text" id="pay${idx}"
                                                    class="form-control" data-bind="value: data.companyLngMirror_payment${idx}, disable: data.isLocked"/>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="radio">
                                                    <label>
                                                        <input type="radio" data-bind="checked: data.companyLngMirror_paymentFocus, disable: data.isLocked"
                                                            value=idx
                                                            name="paymentFocusRadios"/>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row top7">
                                            <div class="form-group">
                                                <label for="payCustomText" class="col-md-2 control-label">
                                                    ${i18n.t('app.invoice.paymentOptCustomTextHeader')}
                                                </label>
                                                <div class="col-sm-6">
                                                    <textarea rows="4" id="payCustomText"
                                                        class="form-control" data-bind="value: data.companyLngMirror_paymentCustomText, disable: data.isLocked"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row top7">
                                            <div class="form-group">
                                                <label for="footerText" class="col-sm-2 control-label">
                                                    ${i18n.t('app.invoice.customTextFieldsFooterTextLbl')}
                                                </label>
                                                <div class="col-sm-6">
                                                    <input type="text" id="footerText"
                                                        class="form-control" data-bind="value: data.companyLngMirror_vatNrCustomText, disable: data.isLocked"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row top7" data-bind="if: isInvoice">
                                            <div class="form-group">
                                                <label for="reverseChargeText" class="col-sm-2 control-label">
                                                    ${i18n.t('app.invoice.customTextFieldsReverseChargeTextLbl')}
                                                </label>
                                                <div class="col-sm-6">
                                                    <textarea rows="4" id="reverseChargeText"
                                                        class="form-control" data-bind="value: data.companyLngMirror_reverseChargeText, disable: data.isLocked" aria-describedby="reverseChargeTextHelp"/>
                                                    <span id="reverseChargeTextHelp" class="help-block">
                                                        ${i18n.t('app.invoice.customTextFieldsReverseChargeHelpText')}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- checkbox panel -->
                    <div class="row">
                        <!-- buttons panel -->
                        <div class="col-md-12">
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-success" data-bind="click: doSaveDoc">
                                    <icon icon="save" extraClass="inline-icon-left-fix"/>
                                    ${i18n.t('app.invoice.saveDocBtn')}
                                </button>
                                <button type="button" class="btn btn-info" data-bind="click: doDocPrint, disable: data._id() == undefined">
                                    <icon icon="print" extraClass="inline-icon-left-fix"/>
                                    ${i18n.t('app.invoice.printDocBtn')}
                                </button>
                                <button type="button" class="btn btn-info" data-bind="click: doCopyDoc, disable: data._id() == undefined">
                                    <icon icon="copy" extraClass="inline-icon-left-fix"/>
                                    ${i18n.t('app.invoice.copyDocBtn')}
                                </button>
                                <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <span class="caret"/>
                                </button>
                                <ul class="dropdown-menu">
                                    <li data-bind="if: isInvoice() && data._id() != undefined">
                                        <a href="#" data-bind="click: doInvoiceReminderPrint">
                                            <icon icon="print" extraClass="inline-icon-left-fix"/>
                                            ${i18n.t('app.invoice.printInvoiceReminderBtn')}
                                        </a>
                                    </li>
                                    <li data-bind="if: isOffer() && data._id() != undefined">
                                        <a href="#" data-bind="click: doCreateInvoiceFromOffer">
                                            <icon icon="cogs" extraClass="inline-icon-left-fix"/>
                                            ${i18n.t('app.invoice.createInvoiceFromOfferBtn')}
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <label class="checkbox-inline left7">
                                <input type="checkbox" data-bind="checked: data.isLocked"/>
                                ${i18n.t('app.invoice.optIsLockedLbl')}
                            </label>
                        </div>
                    </div>
                    <!-- buttons panel -->

                </div>

                <div id="app-invoice_item_group_templates" data-bind="visible: currentView() == 'invoice_item_group_templates'"
                    style="display: none">

                    <form>
                        <p>
                            <ul class="list-group">
                                <li class="list-group-item">
                                    <div class="row">
                                        <h4 class="col-md-offset-4 col-md-7 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.columnNameColHeader')}
                                        </h4>
                                    </div>
                                    <div class="row">
                                        <h4 class="col-md-2 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.nameCol')}
                                        </h4>
                                        <h4 class="col-md-2 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.titleCol')}
                                        </h4>
                                        <h4 class="col-md-2 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.descCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.countCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.priceCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.discountCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.vatCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.groupTemplates.totalCol')}
                                        </h4>
                                    </div>
                                </li>
                                <html-comment>
                                    ko foreach: groupList
                                </html-comment>
                                <li class="list-group-item" data-bind="css: {'list-group-item-warning': isEditMode}">
                                    <div class="row">
                                        <div class="col-md-2">
                                            <itemTextWithEditMode textVariable="name"
                                                cond="true" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-2">
                                            <itemTextWithEditMode textVariable="title"
                                                cond="true" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-2">
                                            <itemTextWithEditMode textVariable="descColLbl"
                                                cond="hasDesc" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="countColLbl"
                                                cond="hasCount" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="priceColLbl"
                                                cond="hasPrice" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="discountColLbl"
                                                cond="hasDiscount" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="vatColLbl"
                                                cond="hasVat" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="totalColLbl"
                                                cond="hasTotal" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="pull-right">
                                                <div class="btn-group btn-group-sm" role="group">

                                                    <button type="button"
                                                        class="btn btn-primary btn-sm" data-bind="click: toggleEditMode">

                                                        <span data-bind="if: isEditMode">
                                                            <icon icon="chevron-up"/>
                                                        </span>
                                                        <span data-bind="ifnot: isEditMode">
                                                            <icon icon="pencil"/>
                                                        </span>

                                                    </button>
                                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle"
                                                        data-toggle="dropdown"
                                                        aria-haspopup="true"
                                                        aria-expanded="false">

                                                        <span class="caret"/>

                                                    </button>
                                                    <ul class="dropdown-menu">
                                                        <li>
                                                            <a href="#" data-bind="click: $parent.deleteGroup">
                                                                <icon icon="trash" extraClass="inline-icon-left-fix"/>
                                                                ${i18n.t('app.groupTemplates.deleteGroupBtn')}
                                                            </a>
                                                        </li>
                                                    </ul>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row"
                                        data-bind="visible: isEditMode">

                                        <div class="col-md-2">
                                        </div>
                                        <div class="col-md-2">
                                        </div>
                                        <div class="col-md-2">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox"
                                                        data-bind="checked: hasDesc"/>
                                                    ${i18n.t('app.groupTemplates.hasDescCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox"
                                                        data-bind="checked: hasCount"/>
                                                    ${i18n.t('app.groupTemplates.hasCountCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox"
                                                        data-bind="checked: hasPrice"/>
                                                    ${i18n.t('app.groupTemplates.hasPriceCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox" data-bind="checked: hasDiscount"/>
                                                    ${i18n.t('app.groupTemplates.hasDiscountCheckLbl')}
                                                </label>
                                            </div>
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox" data-bind="checked: negateDiscount"/>
                                                    ${i18n.t('app.groupTemplates.negateDiscountCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox"
                                                        data-bind="checked: hasVat"/>
                                                    ${i18n.t('app.groupTemplates.hasVatCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox"
                                                        data-bind="checked: hasTotal"/>
                                                    ${i18n.t('app.groupTemplates.hasTotalCheckLbl')}
                                                </label>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row"
                                        data-bind="visible: isEditMode">

                                        <div class="col-md-12">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox" data-bind="checked: hasTitleExtraField"/>
                                                    ${i18n.t('app.groupTemplates.hasTitleExtraFieldCheckLbl')}
                                                </label>
                                            </div>
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox" data-bind="checked: isQuickButton"/>
                                                    ${i18n.t('app.groupTemplates.isQuickButtonCheckLbl')}
                                                </label>
                                            </div>
                                            <div class="checkbox input-sm top0">
                                                <label>
                                                    <input type="checkbox" data-bind="checked: isTextOnlyDefault"/>
                                                    ${i18n.t('app.groupTemplates.isTextOnlyDefaultCheckLbl')}
                                                </label>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row"
                                        data-bind="visible: isEditMode">

                                        <div class="col-md-12">
                                            <div class="btn-group" role="group">
                                                <button type="button"
                                                    class="btn btn-success" data-bind="click: updateServer, visible: isEditMode">
                                                    <icon icon="save" extraClass="inline-icon-left-fix"/>
                                                    ${i18n.t('app.groupTemplates.saveGroupBtn')}
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                </li>
                                <html-comment> /ko </html-comment>
                            </ul>
                        </p>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-success"
                                data-bind="click: newGroup">

                                <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                ${i18n.t('app.groupTemplates.newTemplateBtn')}
                            </button>
                        </div>
                    </form>

                </div>

                <div id="app-articles" data-bind="visible: currentView() == 'articles'"
                    style="display: none">

                    <form>
                        <p>
                            <ul class="list-group">
                                <li class="list-group-item">
                                    <div class="row">
                                        <h4 class="col-md-2 list-group-item-heading">
                                            ${i18n.t('app.articles.groupTemplateRefCol')}
                                        </h4>
                                        <h4 class="col-md-2 list-group-item-heading">
                                            ${i18n.t('app.articles.articleIdCol')}
                                        </h4>
                                        <h4 class="col-md-3 list-group-item-heading">
                                            ${i18n.t('app.articles.descCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.articles.countCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.articles.priceCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.articles.discountCol')}
                                        </h4>
                                        <h4 class="col-md-1 list-group-item-heading">
                                            ${i18n.t('app.articles.vatCol')}
                                        </h4>
                                    </div>
                                </li>
                                <html-comment>
                                    ko foreach: articleList
                                </html-comment>
                                <li class="list-group-item" data-bind="css: {'list-group-item-warning': isEditMode}">
                                    <div class="row">
                                        <div class="col-md-2">
                                            <div data-bind="if: isEditMode">
                                                <select class="form-control" id="articleGroupTemplateIdSelect"
                                                    data-bind="options: $parent.groupList,
                                                               optionsText: 'name',
                                                               value: selectedItemGroupTemplate,
                                                               optionsCaption: t('app.articles.groupTemplateRefSelectNoEntry'),
                                                               enable: isEditMode"/>
                                            </div>
                                            <div data-bind="ifnot: isEditMode">
                                                <p class="list-group-item-text" data-bind="text: itemGroupTemplateRefLbl"/>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <itemTextWithEditMode textVariable="articleId"
                                                cond="true" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-3">
                                            <itemTextWithEditMode textVariable="desc"
                                                cond="true" editModeVariable="isEditMode" useTextarea="true"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="count"
                                                cond="hasCount" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="price"
                                                cond="hasPrice" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="discount"
                                                cond="hasDiscount" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <itemTextWithEditMode textVariable="vat"
                                                cond="hasVat" editModeVariable="isEditMode"/>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="pull-right">
                                                <div class="btn-group btn-group-sm" role="group">

                                                    <button type="button"
                                                        class="btn btn-primary btn-sm" data-bind="click: toggleEditMode">

                                                        <span data-bind="if: isEditMode">
                                                            <icon icon="chevron-up"/>
                                                        </span>
                                                        <span data-bind="ifnot: isEditMode">
                                                            <icon icon="pencil"/>
                                                        </span>

                                                    </button>
                                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle"
                                                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">

                                                        <span class="caret"/>
                                                    </button>
                                                    <ul class="dropdown-menu">
                                                        <li>
                                                            <a href="#" data-bind="click: $parent.deleteArticle">
                                                                <icon icon="trash" extraClass="inline-icon-left-fix"/>
                                                                ${i18n.t('app.articles.deleteArticleBtn')}
                                                            </a>
                                                        </li>
                                                    </ul>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" data-bind="visible: isEditMode">
                                        <div class="col-md-2">
                                        </div>
                                        <div class="col-md-2">
                                        </div>
                                        <div class="col-md-3">
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox"
                                                        data-bind="checked: hasCount"/>
                                                    ${i18n.t('app.articles.hasCountCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox"
                                                        data-bind="checked: hasPrice"/>
                                                    ${i18n.t('app.articles.hasPriceCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox" data-bind="checked: hasDiscount"/>
                                                    ${i18n.t('app.articles.hasDiscountCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox"
                                                        data-bind="checked: hasVat"/>
                                                    ${i18n.t('app.articles.hasVatCheckLbl')}
                                                </label>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row" data-bind="visible: isEditMode">
                                        <div class="col-md-12">
                                            <div class="checkbox input-sm bottom0 top0">
                                                <label>
                                                    <input type="checkbox" data-bind="checked: prependArticleIdToDesc"/>
                                                    ${i18n.t('app.articles.prependArticleIdToDescCheckLbl')}
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row" data-bind="visible: isEditMode">

                                        <div class="col-md-12">
                                            <div class="btn-group" role="group">
                                                <button type="button"
                                                    class="btn btn-success" data-bind="click: updateServer, visible: isEditMode">
                                                    <icon icon="save" extraClass="inline-icon-left-fix"/>
                                                    ${i18n.t('app.articles.saveArticleBtn')}
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                </li>
                                <html-comment> /ko </html-comment>
                            </ul>
                        </p>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-success"
                                data-bind="click: newArticle">

                                <icon icon="plus" extraClass="inline-icon-left-fix"/>
                                ${i18n.t('app.articles.newArticleBtn')}
                            </button>
                        </div>
                    </form>

                </div>

                <div id="app-settings"
                    data-bind="visible: currentView() == 'settings'"
                    style="display: none">

                    <div class="page-header">
                        <h1>${i18n.t('app.settings.pageHeader')}</h1>
                    </div>
                    <div>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">
                                    ${i18n.t('app.settings.userInfoPanelTitle')}
                                </h3>
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="license"
                                                class="control-label">

                                                ${i18n.t('app.settings.licenseLbl')}

                                            </label>
                                            <p class="form-control-static"
                                                id="license"
                                                data-bind="text: settings.license"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="regDate"
                                                class="control-label">

                                                ${i18n.t('app.settings.regDateLbl')}

                                            </label>
                                            <p class="form-control-static"
                                                id="regDate">

                                                ${data.user.registrationDate}

                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="email"
                                                class="control-label">

                                                ${i18n.t('app.settings.emailLbl')}

                                            </label>
                                            <p class="form-control-static"
                                                id="email"
                                                data-bind="text: user.email"/>
                                            <!--
                                            <input type="email" class="form-control" name="email" data-bind="value: user.email"/>
                                            -->
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="name"
                                                class="control-label">

                                                ${i18n.t('app.settings.nameLbl')}

                                            </label>
                                            <input type="text"
                                                class="form-control" name="name"
                                                data-bind="value: user.name"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <button type="button"
                                            class="btn btn-success"
                                            data-bind="click: updateUser">

                                            <icon icon="save" extraClass="inline-icon-left-fix"/>
                                            ${i18n.t('app.settings.updateUserBtn')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div if(data.user.isLocal === true)>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">
                                        ${i18n.t('app.settings.userSecurityPanelTitle')}
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    <form id="local-pwd-update"
                                        action="/api/user-local-pwd-update"
                                        method="post"
                                        data-bind="submit: updatePassword">

                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="oldPwd"
                                                        class="control-label">

                                                        ${i18n.t('app.settings.oldPwdLbl')}

                                                    </label>
                                                    <input type="password"
                                                        class="form-control"
                                                        id="oldPwd" name="oldPwd"
                                                        required/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="newPwd"
                                                        class="control-label">

                                                        ${i18n.t('app.settings.newPwdLbl')}

                                                    </label>
                                                    <input type="password"
                                                        class="form-control"
                                                        id="newPwd" name="newPwd"
                                                        required/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="newPwd2"
                                                        class="control-label">

                                                        ${i18n.t('app.settings.newPwd2Lbl')}

                                                    </label>
                                                    <input type="password"
                                                        class="form-control"
                                                        id="newPwd2"
                                                        name="newPwd2" required/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <button type="submit"
                                                    class="btn btn-warning">

                                                    <icon icon="lock" extraClass="inline-icon-left-fix"/>
                                                    ${i18n.t('app.settings.updatePwdBtn')}
                                                </button>
                                            </div>
                                        </div>

                                    </form>
                                </div>
                            </div>
                        </div>
                        <hr/>
                        <div class="row">
                            <div class="col-md-12">
                                <button type="button" class="btn btn-warning"
                                    data-bind="click: invalidateCache">

                                    <icon icon="trash" extraClass="inline-icon-left-fix"/>
                                    ${i18n.t('app.settings.invalidateCacheBtn')}
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
                <div if(data.user.isAdmin === true)>
                    <div id="app-debug"
                        data-bind="visible: currentView() == 'debug'"
                        style="display: none">

                        <div class="page-header">
                            <h1>${i18n.t('app.debugAndTest.pageHeader')}</h1>
                        </div>
                        <div>
                            <form>
                                <p>
                                </p>
                                <div class="row">
                                    <div class="btn-group" role="group"
                                        aria-label="...">

                                        <button type="button"
                                            class="btn btn-default" data-bind="click: spinnerVisible.bind($data,true), css: { active: spinnerVisible==true}">

                                            ${i18n.t('app.debugAndTest.showSpinnerBtn')}

                                        </button>
                                        <button type="button"
                                            class="btn btn-default" data-bind="click: spinnerVisible.bind($data,false), css: { active: spinnerVisible==false}">

                                            ${i18n.t('app.debugAndTest.hideSpinnerBtn')}

                                        </button>

                                    </div>
                                </div>
                                <p>
                                </p>
                                <div class="row">
                                    <div class="btn-group" role="group"
                                        aria-label="...">

                                        <button type="button"
                                            class="btn btn-default"
                                            data-bind="click: showInfoMsg">

                                            ${i18n.t('app.debugAndTest.showInfoMsgBtn')}

                                        </button>
                                        <button type="button"
                                            class="btn btn-default"
                                            data-bind="click: showSuccessMsg">

                                            ${i18n.t('app.debugAndTest.showSuccessMsgBtn')}

                                        </button>
                                        <button type="button"
                                            class="btn btn-default"
                                            data-bind="click: showWarningMsg">

                                            ${i18n.t('app.debugAndTest.showWarningMsgBtn')}

                                        </button>
                                        <button type="button"
                                            class="btn btn-default"
                                            data-bind="click: showErrorMsg">

                                            ${i18n.t('app.debugAndTest.showErrorMsgBtn')}

                                        </button>

                                    </div>
                                </div>
                                <p>
                                </p>
                                <div class="row">
                                    <div class="btn-group" role="group"
                                        aria-label="...">

                                        <button type="button"
                                            class="btn btn-default"
                                            data-bind="click: downloadLog">

                                            ${i18n.t('app.debugAndTest.getLogBtn')}

                                        </button>

                                    </div>
                                </div>
                            </form>
                        </div>

                    </div>
                    <div id="app-users"
                        data-bind="visible: currentView() == 'users'"
                        style="display: none">

                        <form>
                            <p>
                                <ul class="list-group">
                                    <li class="list-group-item">
                                        <div class="row">
                                            <h4 class="col-md-2 list-group-item-heading">
                                                ${i18n.t('app.userList.nameCol')}
                                            </h4>
                                            <h4 class="col-md-3 list-group-item-heading">
                                                ${i18n.t('app.userList.emailCol')}
                                            </h4>
                                            <h4 class="col-md-1 list-group-item-heading">
                                                ${i18n.t('app.userList.typeCol')}
                                            </h4>
                                            <h4 class="col-md-1 list-group-item-heading">
                                                ${i18n.t('app.userList.licenseCol')}
                                            </h4>
                                            <h4 class="col-md-3 list-group-item-heading">
                                                ${i18n.t('app.userList.accessCol')}
                                            </h4>
                                            <h4 class="col-md-1 list-group-item-heading">
                                                ${i18n.t('app.userList.accessCountCol')}
                                            </h4>
                                        </div>
                                    </li>
                                    <html-comment>
                                        ko foreach: userList
                                    </html-comment>
                                    <li class="list-group-item">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <p class="list-group-item-text"
                                                    data-bind="text: info.name"/>
                                            </div>
                                            <div class="col-md-3">
                                                <p class="list-group-item-text"
                                                    data-bind="text: info.email"/>
                                            </div>
                                            <div class="col-md-1">
                                                <p class="list-group-item-text"
                                                    data-bind="text: type"/>
                                            </div>
                                            <div class="col-md-1">
                                                <p class="list-group-item-text" data-bind="text: settings().license"/>
                                            </div>
                                            <div class="col-md-3">
                                                <p class="list-group-item-text"
                                                    data-bind="text: lastAccessDateStr"/>
                                            </div>
                                            <div class="col-md-1">
                                                <p class="list-group-item-text"
                                                    data-bind="text: info.accessCount"/>
                                            </div>
                                            <div class="col-md-1">
                                                <button type="button"
                                                    class="btn btn-default" data-bind="click: toggleDetailedInfo">

                                                    <span data-bind="if: isDetailsVisible">
                                                        <icon icon="chevron-up"/>
                                                    </span>
                                                    <span data-bind="ifnot: isDetailsVisible">
                                                        <icon icon="chevron-down"/>
                                                    </span>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="row"
                                            data-bind="visible: isDetailsVisible">

                                            <div class="col-md-11">
                                                <div class="panel panel-default">
                                                    <div class="panel-body">
                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <dl class="dl-horizontal">
                                                                    <dt>
                                                                        ${i18n.t('app.userList.uidLbl')}
                                                                    </dt>
                                                                    <dd>
                                                                        <span data-bind="text: _id"/>
                                                                    </dd>
                                                                    <dt>
                                                                        ${i18n.t('app.userList.isAdminLbl')}
                                                                    </dt>
                                                                    <dd>
                                                                        <condCheckIcon cond="info.isAdmin"/>
                                                                    </dd>
                                                                    <dt>
                                                                        ${i18n.t('app.userList.regDateLbl')}
                                                                    </dt>
                                                                    <dd>
                                                                        <span data-bind="text: info.registrationDate"/>
                                                                    </dd>
                                                                    <dt>
                                                                        ${i18n.t('app.userList.numCompaniesLbl')}
                                                                    </dt>
                                                                    <dd>
                                                                        <span data-bind="text: totalStats().numCompanies"/>
                                                                    </dd>
                                                                    <dt>
                                                                        ${i18n.t('app.userList.numCustomersLbl')}
                                                                    </dt>
                                                                    <dd>
                                                                        <span data-bind="text: totalStats().numCustomers"/>
                                                                    </dd>
                                                                    <dt>
                                                                        ${i18n.t('app.userList.numInvoicesLbl')}
                                                                    </dt>
                                                                    <dd>
                                                                        <span data-bind="text: totalStats().numInvoices"/>
                                                                    </dd>
                                                                    <dt>
                                                                        ${i18n.t('app.userList.numOffersLbl')}
                                                                    </dt>
                                                                    <dd>
                                                                        <span data-bind="text: totalStats().numOffers"/>
                                                                    </dd>
                                                                    <dt>
                                                                        ${i18n.t('app.userList.numItemGroupTemplatesLbl')}
                                                                    </dt>
                                                                    <dd>
                                                                        <span data-bind="text: totalStats().numItemGroupTemplates"/>
                                                                    </dd>
                                                                </dl>
                                                            </div>
                                                        </div>
                                                        <div class="row"
                                                            data-bind="ifnot: isSelf">

                                                            <div class="col-md-12">
                                                                <a type="button" class="btn btn-warning" data-bind="attr: {href: '/loginAs/' + _id()}">
                                                                    <icon icon="sign-in" extraClass="inline-icon-left-fix"/>
                                                                    ${i18n.t('app.userList.loginAsOtherUserBtn')}
                                                                </a>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </li>
                                    <html-comment> /ko </html-comment>
                                </ul>
                            </p>
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-default"
                                    data-bind="click: refresh">

                                    <icon icon="refresh" extraClass="inline-icon-left-fix"/>
                                    ${i18n.t('app.userList.refreshBtn')}
                                </button>
                            </div>
                        </form>

                    </div>
                    <div id="app-invites"
                        data-bind="visible: currentView() == 'invites'"
                        style="display: none">

                        <form>
                            <p>
                                <table class="table table-striped table-condensed">
                                    <thead>
                                        <tr>
                                            <th>
                                                ${i18n.t('app.inviteList.emailCol')}
                                            </th>
                                            <th>
                                                ${i18n.t('app.inviteList.licenseCol')}
                                            </th>
                                            <th>
                                                ${i18n.t('app.inviteList.isAdminCol')}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody data-bind="foreach: inviteList">
                                        <tr>
                                            <td>
                                                <p class="form-control-static"
                                                    data-bind="text: email"/>
                                            </td>
                                            <td>
                                                <p class="form-control-static"
                                                    data-bind="text: license"/>
                                            </td>
                                            <td>
                                                <p class="form-control-static">
                                                    <condCheckIcon cond="isAdmin"/>
                                                </p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </p>
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-default"
                                    data-bind="click: refresh">

                                    <icon icon="refresh" extraClass="inline-icon-left-fix"/>
                                    ${i18n.t('app.inviteList.refreshBtn')}
                                </button>
                            </div>
                        </form>

                    </div>
                </div>
                <!-- End isAdmin -->
            </div>
        </div>
    </body>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="jquery-ui.min.js"></script>
    <script type="text/javascript" src="bootstrap.min.js"></script>
    <script type="text/javascript" src="tooltip.js"></script>
    <script type="text/javascript" src="knockout-latest.js"></script>
    <script type="text/javascript" src="knockout-bootstrap.js"></script>
    <script type="text/javascript" src="director.min.js"></script>
    <script type="text/javascript" src="i18next.min.js"></script>
    <script type="text/javascript" src="i18nextXHRBackend.min.js"></script>
    <script type="text/javascript" src="cache.js"></script>
    <script type="text/javascript" src="knockout-jqAutocomplete.min.js"></script>
    <!-- Input to javascripts below -->
    <script type="text/javascript">
        var cfg = {
            showInitialTicker: true,
            tickerText: "${i18n.t('app.tickerText')}",
            notificationAreaPlacement: "right",
            user: {
              _id: "${data.user._id}",
              name: "${data.user.name}",
              email: "${data.user.email}",
              isAdmin: ${data.user.isAdmin},
              registrationDate: "${data.user.registrationDate}",
              isĹocal: ${data.user.isLocal}
            }
        };
        var serverMsg = {
            error: "${data.msg.error}",
            success: "${data.msg.success}",
            notice: "${data.msg.notice}"
        };
    </script>
    <script type="text/javascript" src="util.js"></script>
    <script type="text/javascript" src="default.js"></script>
    <script type="text/javascript" src="notification.js"></script>
    <script type="text/javascript" src="page.js"></script>
</html>
